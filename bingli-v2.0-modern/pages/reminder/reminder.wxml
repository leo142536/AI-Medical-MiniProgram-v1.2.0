<!--pages/reminder/reminder.wxml-->
<!-- åŸºäºGitHubæœ€ä½³å®è·µçš„ç°ä»£åŒ–æé†’é¡µé¢ -->
<view class="reminder-container">
  <!-- ç°ä»£åŒ–æ ‡ç­¾æ  -->
  <view class="modern-tab-bar">
    <view 
      wx:for="{{tabs}}" 
      wx:key="index"
      class="modern-tab-item {{activeTab === index ? 'active' : ''}}"
      data-index="{{index}}"
      bind:tap="onTabChange"
    >
      <text class="tab-text">{{item.title}}</text>
      <view wx:if="{{item.count > 0}}" class="tab-badge">{{item.count}}</view>
    </view>
    <view class="tab-indicator" style="transform: translateX({{activeTab * 100}}%)"></view>
  </view>

  <!-- æ·»åŠ æŒ‰é’® -->
  <view class="add-section">
    <button class="modern-btn primary-btn add-reminder-btn" bind:tap="onAddReminder">
      <text class="add-icon">+</text>
      <text class="add-text">æ·»åŠ æé†’</text>
    </button>
  </view>

  <!-- ä»Šæ—¥æé†’ -->
  <view wx:if="{{activeTab === 0}}" class="reminder-section">
    <view wx:if="{{todayReminders.length === 0}}" class="empty-state">
      <loading-indicator 
        type="skeleton" 
        text="ä»Šæ—¥æš‚æ— æé†’äº‹é¡¹" 
        size="medium"
      />
    </view>
    
    <view class="modern-cards-container" wx:else>
      <modern-card 
        wx:for="{{todayReminders}}" 
        wx:key="id"
        title="{{item.title}}"
        subtitle="{{item.time}} Â· {{item.member}}"
        description="{{item.description}}"
        type="reminder"
        size="medium"
        class="reminder-card today {{item.urgent ? 'urgent' : ''}}"
        bind:tap="onReminderTap"
        data-id="{{item.id}}"
      >
        <!-- æé†’ç±»å‹å›¾æ ‡ -->
        <view slot="icon" class="reminder-icon {{item.type}}">
          <text class="icon-text">{{item.type === 'medicine' ? 'ğŸ’Š' : 'ğŸ¥'}}</text>
        </view>

        <!-- ç´§æ€¥æ ‡è¯† -->
        <view slot="badge" wx:if="{{item.urgent}}" class="urgent-badge">
          ç´§æ€¥
        </view>

        <!-- æé†’çŠ¶æ€ -->
        <view slot="status" class="reminder-status">
          <view class="status-dot {{item.completed ? 'completed' : 'pending'}}"></view>
          <text class="status-text">{{item.completed ? 'å·²å®Œæˆ' : 'å¾…å®Œæˆ'}}</text>
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view slot="footer" class="reminder-actions">
          <button 
            class="modern-btn success-btn action-btn"
            catch:tap="onCompleteReminder"
            data-id="{{item.id}}"
            wx:if="{{!item.completed}}"
          >
            âœ“ å®Œæˆ
          </button>
          <button 
            class="modern-btn secondary-btn action-btn"
            catch:tap="onEditReminder"
            data-id="{{item.id}}"
          >
            ç¼–è¾‘
          </button>
          <view 
            class="more-actions"
            catch:tap="onReminderMoreActions"
            data-id="{{item.id}}"
          >
            <text class="more-icon">â‹¯</text>
          </view>
        </view>
      </modern-card>
    </view>
  </view>

  <!-- å³å°†åˆ°æ¥çš„æé†’ -->
  <view wx:if="{{activeTab === 1}}" class="reminder-section">
    <view wx:if="{{upcomingReminders.length === 0}}" class="empty-state">
      <loading-indicator 
        type="skeleton" 
        text="æš‚æ— å³å°†åˆ°æ¥çš„æé†’" 
        size="medium"
      />
    </view>
    
    <view class="modern-cards-container" wx:else>
      <modern-card 
        wx:for="{{upcomingReminders}}" 
        wx:key="id"
        title="{{item.title}}"
        subtitle="{{item.date}} {{item.time}} Â· {{item.member}}"
        description="{{item.description}}"
        type="upcoming"
        size="medium"
        class="reminder-card upcoming"
        bind:tap="onReminderTap"
        data-id="{{item.id}}"
      >
        <!-- æé†’ç±»å‹å›¾æ ‡ -->
        <view slot="icon" class="reminder-icon {{item.type}}">
          <text class="icon-text">{{item.type === 'medicine' ? 'ğŸ’Š' : 'ğŸ¥'}}</text>
        </view>

        <!-- å€’è®¡æ—¶ -->
        <view slot="badge" class="countdown-badge">
          {{item.countdown}}
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view slot="footer" class="reminder-actions">
          <button 
            class="modern-btn secondary-btn action-btn"
            catch:tap="onEditReminder"
            data-id="{{item.id}}"
          >
            ç¼–è¾‘
          </button>
          <button 
            class="modern-btn warning-btn action-btn"
            catch:tap="onSnoozeReminder"
            data-id="{{item.id}}"
          >
            å»¶å
          </button>
        </view>
      </modern-card>
    </view>
  </view>

  <!-- å…¨éƒ¨æé†’ -->
  <view wx:if="{{activeTab === 2}}" class="reminder-section">
    <view wx:if="{{reminders.length === 0 && !loading}}" class="empty-state">
      <loading-indicator 
        type="skeleton" 
        text="æš‚æ— æé†’è®°å½•" 
        size="medium"
      />
    </view>

    <!-- åŠ è½½ä¸­çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-state">
      <loading-indicator 
        type="spinner" 
        text="æ­£åœ¨åŠ è½½æé†’è®°å½•..." 
        size="large"
      />
    </view>
    
    <view class="modern-cards-container" wx:else>
      <modern-card 
        wx:for="{{reminders}}" 
        wx:key="id"
        title="{{item.title}}"
        subtitle="{{item.date}} {{item.time}} Â· {{item.member}}"
        description="{{item.description}}"
        type="history"
        size="medium"
        class="reminder-card history {{item.status}}"
        bind:tap="onReminderTap"
        data-id="{{item.id}}"
      >
        <!-- æé†’ç±»å‹å›¾æ ‡ -->
        <view slot="icon" class="reminder-icon {{item.type}}">
          <text class="icon-text">{{item.type === 'medicine' ? 'ğŸ’Š' : 'ğŸ¥'}}</text>
        </view>

        <!-- çŠ¶æ€æ ‡è¯† -->
        <view slot="badge" class="status-badge {{item.status}}">
          {{item.status === 'completed' ? 'å·²å®Œæˆ' : 'å¾…å®Œæˆ'}}
        </view>

        <!-- æ“ä½œæŒ‰é’® -->
        <view slot="footer" class="reminder-actions">
          <button 
            class="modern-btn success-btn action-btn"
            catch:tap="onCompleteReminder"
            data-id="{{item.id}}"
            wx:if="{{item.status !== 'completed'}}"
          >
            âœ“ å®Œæˆ
          </button>
          <button 
            class="modern-btn secondary-btn action-btn"
            catch:tap="onEditReminder"
            data-id="{{item.id}}"
            wx:if="{{item.status !== 'completed'}}"
          >
            ç¼–è¾‘
          </button>
          <view 
            class="more-actions"
            catch:tap="onReminderMoreActions"
            data-id="{{item.id}}"
          >
            <text class="more-icon">â‹¯</text>
          </view>
        </view>
      </modern-card>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{hasMore && reminders.length > 0}}">
      <loading-indicator 
        wx:if="{{loadingMore}}" 
        type="dots" 
        text="æ­£åœ¨åŠ è½½æ›´å¤š..." 
        size="small"
      />
      <text wx:else class="load-more-text">ä¸Šæ‹‰åŠ è½½æ›´å¤š</text>
    </view>
  </view>
</view> 