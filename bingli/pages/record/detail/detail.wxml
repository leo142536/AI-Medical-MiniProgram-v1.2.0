<!--pages/record/detail/detail.wxml-->
<view class="record-detail-container">
  <!-- é¡¶éƒ¨æ“ä½œæ  -->
  <view class="top-actions">
    <button class="action-btn edit-btn" bindtap="onEdit">
      <text class="btn-icon">âœï¸</text>
      <text>ç¼–è¾‘</text>
    </button>
    <button class="action-btn share-btn" bindtap="onShare">
      <text class="btn-icon">ğŸ“¤</text>
      <text>åˆ†äº«</text>
    </button>
    <button class="action-btn delete-btn" bindtap="onDelete">
      <text class="btn-icon">ğŸ—‘ï¸</text>
      <text>åˆ é™¤</text>
    </button>
  </view>

  <!-- ç—…å†åŸºæœ¬ä¿¡æ¯ -->
  <view class="record-info-card">
    <view class="record-header">
      <text class="record-title">{{recordDetail.title}}</text>
      <view class="record-meta">
        <text class="record-date">{{recordDetail.date}} {{recordDetail.time}}</text>
        <text class="record-member">{{recordDetail.member}}</text>
      </view>
    </view>
    
    <view class="hospital-info">
      <view class="hospital-item">
        <text class="label">åŒ»é™¢ï¼š</text>
        <text class="value hospital-name" bindtap="onNavigateToHospital">{{recordDetail.hospital}}</text>
        <text class="hospital-phone" bindtap="onCallHospital">ğŸ“</text>
      </view>
      <view class="hospital-item" wx:if="{{recordDetail.department}}">
        <text class="label">ç§‘å®¤ï¼š</text>
        <text class="value">{{recordDetail.department}}</text>
      </view>
      <view class="hospital-item" wx:if="{{recordDetail.doctor}}">
        <text class="label">åŒ»ç”Ÿï¼š</text>
        <text class="value">{{recordDetail.doctor}}</text>
      </view>
    </view>
  </view>

  <!-- è¯Šæ–­ä¿¡æ¯ -->
  <view class="diagnosis-card" wx:if="{{recordDetail.diagnosis}}">
    <view class="card-header">
      <text class="card-title">è¯Šæ–­ç»“æœ</text>
      <text class="card-icon">ğŸ¥</text>
    </view>
    <view class="diagnosis-content">
      <text class="diagnosis-text">{{recordDetail.diagnosis}}</text>
    </view>
  </view>

  <!-- ç—‡çŠ¶æè¿° -->
  <view class="symptoms-card" wx:if="{{recordDetail.symptoms}}">
    <view class="card-header">
      <text class="card-title">ç—‡çŠ¶æè¿°</text>
      <text class="card-icon">ğŸ¤’</text>
    </view>
    <view class="symptoms-content">
      <text class="symptoms-text">{{recordDetail.symptoms}}</text>
    </view>
  </view>

  <!-- æ²»ç–—æ–¹æ¡ˆ -->
  <view class="treatment-card" wx:if="{{recordDetail.treatment}}">
    <view class="card-header">
      <text class="card-title">æ²»ç–—æ–¹æ¡ˆ</text>
      <text class="card-icon">ğŸ’Š</text>
    </view>
    <view class="treatment-content">
      <text class="treatment-text">{{recordDetail.treatment}}</text>
    </view>
  </view>

  <!-- å¤„æ–¹è¯ç‰© -->
  <view class="prescriptions-card" wx:if="{{recordDetail.prescriptions && recordDetail.prescriptions.length > 0}}">
    <view class="card-header">
      <text class="card-title">å¤„æ–¹è¯ç‰©</text>
      <text class="card-icon">ğŸ’‰</text>
    </view>
    <view class="prescriptions-list">
      <view 
        wx:for="{{recordDetail.prescriptions}}" 
        wx:key="name"
        class="prescription-item"
      >
        <view class="prescription-header">
          <text class="medicine-name">{{item.name}}</text>
          <text class="medicine-dosage">{{item.dosage}}</text>
        </view>
        <view class="prescription-details">
          <text class="medicine-frequency">{{item.frequency}}</text>
          <text class="medicine-duration">æŒç»­{{item.duration}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç—…å†å›¾ç‰‡ -->
  <view class="images-card" wx:if="{{recordDetail.images && recordDetail.images.length > 0}}">
    <view class="card-header">
      <text class="card-title">ç—…å†å›¾ç‰‡</text>
      <text class="card-icon">ğŸ“·</text>
    </view>
    <view class="images-grid">
      <view 
        wx:for="{{recordDetail.images}}" 
        wx:key="*this"
        class="image-item"
        data-url="{{item}}"
        data-urls="{{recordDetail.images}}"
        bindtap="onPreviewImage"
      >
        <image src="{{item}}" class="record-image" mode="aspectFill" />
      </view>
    </view>
  </view>

  <!-- å¤‡æ³¨ä¿¡æ¯ -->
  <view class="notes-card" wx:if="{{recordDetail.notes}}">
    <view class="card-header">
      <text class="card-title">å¤‡æ³¨ä¿¡æ¯</text>
      <text class="card-icon">ğŸ“</text>
    </view>
    <view class="notes-content">
      <text class="notes-text">{{recordDetail.notes}}</text>
    </view>
  </view>

  <!-- è´¹ç”¨ä¿¡æ¯ -->
  <view class="cost-card" wx:if="{{recordDetail.cost}}">
    <view class="card-header">
      <text class="card-title">è´¹ç”¨ä¿¡æ¯</text>
      <text class="card-icon">ğŸ’°</text>
    </view>
    <view class="cost-content">
      <text class="cost-amount">Â¥{{recordDetail.cost}}</text>
    </view>
  </view>

  <!-- å¤è¯Šä¿¡æ¯ -->
  <view class="follow-up-card" wx:if="{{recordDetail.nextVisit}}">
    <view class="card-header">
      <text class="card-title">å¤è¯Šå®‰æ’</text>
      <text class="card-icon">ğŸ“…</text>
    </view>
    <view class="follow-up-content">
      <text class="follow-up-date">{{recordDetail.nextVisit}}</text>
      <button class="reminder-btn" bindtap="onSetReminder">è®¾ç½®æé†’</button>
    </view>
  </view>

  <!-- åˆ†äº«å¼¹çª— -->
  <view class="share-modal" wx:if="{{showShareModal}}">
    <view class="modal-mask" bindtap="onCloseShareModal"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">åˆ†äº«ç—…å†</text>
        <text class="modal-close" bindtap="onCloseShareModal">Ã—</text>
      </view>
      <view class="share-options">
        <button class="share-option" bindtap="onShareToFamily">
          <text class="option-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</text>
          <text class="option-text">åˆ†äº«ç»™å®¶äºº</text>
        </button>
        <button class="share-option" bindtap="onExportPDF">
          <text class="option-icon">ğŸ“„</text>
          <text class="option-text">å¯¼å‡ºPDF</text>
        </button>
      </view>
    </view>
  </view>
</view> 