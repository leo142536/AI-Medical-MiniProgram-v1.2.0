<!-- pages/home/home-optimized.wxml - ä¼˜åŒ–åçš„é¦–é¡µ -->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯åŒºåŸŸ - ä¼˜åŒ–å -->
  <view class="user-section-modern">
    <view class="user-card">
      <view class="user-avatar">
        <image 
          class="avatar-modern avatar-large" 
          src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" 
          mode="aspectFill"
        />
        <view class="status-indicator status-online"></view>
      </view>
      <view class="user-info">
        <text class="greeting text-xl">{{timeGreeting}}</text>
        <text class="user-name text-2xl">{{userInfo.nickName || 'ç”¨æˆ·'}}</text>
        <view class="weather-info">
          <text class="weather text-sm">{{weather || 'è·å–å¤©æ°”ä¸­...'}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œåŒºåŸŸ - ä¼˜åŒ–å -->
  <view class="quick-actions-modern">
    <view class="actions-grid grid-3">
      <view 
        class="action-item-modern touchable" 
        wx:for="{{quickActions}}" 
        wx:key="id"
        data-id="{{item.id}}"
        data-path="{{item.path}}"
        bindtap="onQuickActionTap"
      >
        <view class="action-icon-modern">
          <text class="action-icon-text">{{item.icon}}</text>
        </view>
        <text class="action-title text-sm">{{item.title}}</text>
        <view class="action-badge" wx:if="{{item.badge}}">
          <text class="badge">{{item.badge}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç»Ÿè®¡æ¦‚è§ˆå¡ç‰‡ - æ–°å¢ -->
  <view class="stats-section">
    <view class="stats-grid grid-2">
      <view class="stat-card card-modern touchable-card">
        <view class="stat-icon">ğŸ“Š</view>
        <view class="stat-info">
          <text class="stat-number text-xl">{{totalRecords || 0}}</text>
          <text class="stat-label text-xs">ç—…å†è®°å½•</text>
        </view>
      </view>
      <view class="stat-card card-modern touchable-card">
        <view class="stat-icon">ğŸ‘¥</view>
        <view class="stat-info">
          <text class="stat-number text-xl">{{familyMembers.length || 0}}</text>
          <text class="stat-label text-xs">å®¶åº­æˆå‘˜</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å®¶åº­æˆå‘˜åŒºåŸŸ - ä¼˜åŒ–å -->
  <view class="section-modern family-section">
    <view class="section-header-modern">
      <text class="section-title text-lg">å®¶åº­æˆå‘˜</text>
      <view class="header-actions">
        <view class="action-btn-modern add-btn" bindtap="onAddFamilyMember">
          <text class="btn-icon">+</text>
        </view>
        <view class="action-btn-modern delete-btn" bindtap="onToggleDeleteMode">
          <text class="btn-icon">{{isDeleteMode ? 'âœ“' : 'âˆ’'}}</text>
        </view>
        <text class="section-more text-sm touchable" bindtap="onViewMoreFamily">æŸ¥çœ‹å…¨éƒ¨</text>
      </view>
    </view>
    
    <scroll-view class="member-scroll-modern" scroll-x="true">
      <view class="member-list-modern">
        <view 
          class="member-card-modern {{isDeleteMode ? 'delete-mode' : ''}}" 
          wx:for="{{familyMembers}}" 
          wx:key="id"
          data-id="{{item.id}}"
          bindtap="onFamilyMemberTap"
        >
          <view class="member-avatar-container">
            <image 
              class="avatar-modern avatar-medium" 
              src="{{item.avatar || '/images/default-avatar.png'}}" 
              mode="aspectFill"
            />
            <view class="member-relation-badge">
              <text class="tag tag-primary">{{item.relation}}</text>
            </view>
            <!-- åˆ é™¤æŒ‰é’® -->
            <view 
              wx:if="{{isDeleteMode && item.relation !== 'æœ¬äºº'}}" 
              class="delete-member-btn-modern"
              data-id="{{item.id}}"
              data-name="{{item.name}}"
              bindtap="onDeleteMember"
            >
              <text class="delete-icon">Ã—</text>
            </view>
          </view>
          <text class="member-name text-base">{{item.name}}</text>
          <view class="member-status">
            <view class="status-indicator {{item.healthStatus === 'good' ? 'status-online' : 'status-warning'}}"></view>
            <text class="status-text text-xs">{{item.healthStatus === 'good' ? 'å¥åº·' : 'éœ€å…³æ³¨'}}</text>
          </view>
        </view>
        
        <!-- æ·»åŠ æˆå‘˜å¡ç‰‡ -->
        <view class="member-card-modern add-member-card" wx:if="{{familyMembers.length === 0}}" bindtap="onAddFamilyMember">
          <view class="add-member-content">
            <view class="add-icon-large">+</view>
            <text class="add-text text-sm">æ·»åŠ æˆå‘˜</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- æœ€è¿‘æ´»åŠ¨æ—¶é—´çº¿ - ä¼˜åŒ–å -->
  <view class="section-modern activity-section" wx:if="{{recentActivities.length > 0}}">
    <view class="section-header-modern">
      <text class="section-title text-lg">æœ€è¿‘æ´»åŠ¨</text>
      <text class="section-more text-sm touchable" bindtap="onViewMoreActivities">æŸ¥çœ‹æ›´å¤š</text>
    </view>
    <view class="activity-timeline">
      <view 
        class="timeline-item" 
        wx:for="{{recentActivities}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="onActivityTap"
      >
        <view class="timeline-dot {{item.type}}"></view>
        <view class="timeline-content card-modern">
          <view class="activity-header">
            <text class="activity-title text-base">{{item.title}}</text>
            <text class="activity-time text-xs">{{item.time}}</text>
          </view>
          <text class="activity-desc text-sm">{{item.description}}</text>
          <view class="activity-meta">
            <text class="meta-item text-xs">{{item.member}}</text>
            <view class="meta-tags">
              <text class="tag tag-{{item.type}}">{{item.typeLabel}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¥åº·æé†’ - ä¼˜åŒ–å -->
  <view class="section-modern reminders-section" wx:if="{{upcomingReminders.length > 0}}">
    <view class="section-header-modern">
      <text class="section-title text-lg">å¥åº·æé†’</text>
      <text class="section-more text-sm touchable" bindtap="onViewMoreReminders">æŸ¥çœ‹æ›´å¤š</text>
    </view>
    <view class="reminder-cards">
      <view 
        class="reminder-card-modern card-modern" 
        wx:for="{{upcomingReminders}}" 
        wx:key="id"
        data-id="{{item.id}}"
        bindtap="onReminderTap"
      >
        <view class="reminder-header">
          <view class="reminder-icon {{item.type}}">
            <text>{{item.type === 'medical' ? 'ğŸ¥' : 'ğŸ’Š'}}</text>
          </view>
          <view class="reminder-priority">
            <view class="priority-indicator priority-{{item.priority}}"></view>
          </view>
        </view>
        <view class="reminder-content">
          <text class="reminder-title text-base">{{item.title}}</text>
          <text class="reminder-desc text-sm">{{item.description}}</text>
          <view class="reminder-meta">
            <text class="meta-member text-xs">{{item.member}}</text>
            <text class="meta-time text-xs">{{item.time}}</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ - ä¼˜åŒ–å -->
  <view class="empty-state-modern" wx:if="{{!hasData}}">
    <view class="empty-animation">
      <text class="empty-icon">ğŸ¥</text>
    </view>
    <text class="empty-title">æ¬¢è¿ä½¿ç”¨AIç—…ä¾‹ç®¡ç†</text>
    <text class="empty-desc">å¼€å§‹ç®¡ç†æ‚¨çš„å®¶åº­å¥åº·ä¿¡æ¯ï¼Œäº«å—æ™ºèƒ½åŒ–çš„å¥åº·ç®¡ç†ä½“éªŒ</text>
    <view class="empty-actions">
      <button class="btn-modern btn-modern-primary" bindtap="onStartUse">å¼€å§‹ä½¿ç”¨</button>
      <button class="btn-modern btn-modern-secondary" bindtap="onViewDemo">æŸ¥çœ‹æ¼”ç¤º</button>
    </view>
  </view>

  <!-- æµ®åŠ¨æ“ä½œæŒ‰é’® -->
  <view class="fab" bindtap="onFabTap">
    <text class="fab-icon">+</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{isLoading}}">
    <view class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text text-sm">åŠ è½½ä¸­...</text>
    </view>
  </view>
</view> 